"0","# Standardize country names to ISO3 codes"
"0","heritage$ISO3 <- countrycode(heritage$Country, ""country.name"", ""iso3c"")"
"2","Warning: Some values were not matched unambiguously: kosovo, micronesia
"
"0","fraser_aggregate$ISO3 <- countrycode(fraser_aggregate$Country, ""country.name"", ""iso3c"")"
"0",""
"0","# Merge using standardized ISO codes"
"0","merged_data <- full_join(heritage, fraser_aggregate, by = c(""ISO3"", ""Year""))"
"0",""
"0","# Ensure Fraser's country names are used unless NA"
"0","merged_data <- merged_data %>%"
"0","  mutate(Country = coalesce(Country.y, Country.x)) %>%  # Use Fraser's names unless NA"
"0","  select(ISO3, Country, Year, everything(), -Country.x, -Country.y)  # Reorder columns"
"0",""
