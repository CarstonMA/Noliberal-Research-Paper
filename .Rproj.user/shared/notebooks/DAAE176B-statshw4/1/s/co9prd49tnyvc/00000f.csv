"0","df <- read.csv(""core_temp.csv"")"
"0",""
"0","# serious infection defined by experiencing one of these"
"0","outcome_vars <- c(""SSIDeep.fascia."","
"0","                  ""Sepsis"","
"0","                  ""SSIOrganSpace"","
"0","                  ""Pneumonia"","
"0","                  ""Pneumonia.aspiration."","
"0","                  ""AbsessIntraAb"","
"0","                  ""AbsessPelvic"","
"0","                  ""Cdiff"")"
"0",""
"0","# remove vars that we shouldn't use for prediction"
"0","df <- df %>%"
"0","  dplyr::select(-all_of(c(""DurationHosp"",""LOS"",""DEAD"", "
"0","                          outcome_vars,"
"0","                          ""AnyInfection"", ""SuperficialInfection"","
"0","                          ""FascialDehiscence"", ""DelayedHealing"", ""Infection"","
"0","                          ""Sinus"", ""SSISuperficial.skin."", ""WoundInfection"")))"
"0",""
"0",""
"0","# change vars to categorical"
"0","num_vars <-  c(""Age"",""BMI"",""CharlsonScore"", ""TWATemp"" ,"
"0","               ""LastReadingTemp"",  ""EndCaseTemp"",""SurgDuration"", "
"0","               ""SeriousInfection"")"
"0","cat_vars <- names(df)[!(names(df) %in% num_vars)]"
"0","df[cat_vars] <- lapply(df[cat_vars], as.factor)"
"0",""
"0","# surgery type is NA so drop"
"0","df <- df %>% dplyr::select(-c(SurgeryType))"
"0","df <- na.omit(df)"
"0",""
"0","# Get test train split"
"0","df$Y <- df$SeriousInfection"
"0","df <- df %>% dplyr::select(-c(SeriousInfection))"
"0","train_ids <- df$YEAR %in% c(2009, 2010)"
"0","dftrain <- df[train_ids,] %>% dplyr::select(-c(YEAR))"
"0","dftest <- df[!train_ids,] %>% dplyr::select(-c(YEAR))"
"0",""
"0",""
"0","# Split variables"
"0","numeric_vars <- dftrain %>% select(where(is.numeric)) %>% select(-Y) %>% names()"
"0","categorical_vars <- dftrain %>% select(where(is.factor)) %>% names()"
"0",""
"0","# Summary for numeric variables"
"0","numeric_summary <- dftrain %>%"
"0","  group_by(Y) %>%"
"0","  summarise(across(all_of(numeric_vars),"
"0","                   list(mean = ~mean(.x, na.rm = TRUE),"
"0","                        sd = ~sd(.x, na.rm = TRUE)),"
"0","                   .names = ""{.col}_{.fn}""),"
"0","            .groups = ""drop"") %>%"
"0","  pivot_longer(-Y, names_to = c(""Variable"", "".value""), names_sep = ""_"")"
"0",""
"0","# Summary for categorical variables"
"0","categorical_summary <- dftrain %>%"
"0","  select(Y, all_of(categorical_vars)) %>%"
"0","  pivot_longer(-Y, names_to = ""Variable"", values_to = ""Value"") %>%"
"0","  group_by(Y, Variable, Value) %>%"
"0","  summarise(Count = n(), .groups = ""drop"") %>%"
"0","  group_by(Variable, Y) %>%"
"0","  mutate(Proportion = Count / sum(Count)) %>%"
"0","  ungroup()"
"0",""
"0","# Output both tables"
"0","list("
"0","  NumericSummary = numeric_summary,"
"0","  CategoricalSummary = categorical_summary"
"0",")"
"1","$NumericSummary
"
