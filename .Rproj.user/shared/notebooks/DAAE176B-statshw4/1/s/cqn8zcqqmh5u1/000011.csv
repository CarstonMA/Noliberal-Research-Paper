"0","# Get predicted probabilities"
"0","pred_probs <- predict(model_lr, type = ""response"")"
"0",""
"0","# Calibration plot data (10 bins)"
"0","calib_df <- dftrain %>%"
"0","  mutate(pred_prob = pred_probs,"
"0","         bin = ntile(pred_prob, 10)) %>%"
"0","  group_by(bin) %>%"
"0","  summarise("
"0","    mean_pred = mean(pred_prob),"
"0","    obs_rate = mean(Y),"
"0","    n = n()"
"0","  )"
"0",""
"0","# Plot"
"0","ggplot(calib_df, aes(x = mean_pred, y = obs_rate)) +"
"0","  geom_point(size = 2) +"
"0","  geom_line() +"
"0","  geom_abline(intercept = 0, slope = 1, linetype = ""dashed"", color = ""gray"") +"
"0","  labs(x = ""Mean Predicted Probability"","
"0","       y = ""Observed Proportion of Serious Infection"","
"0","       title = ""Calibration Plot: Logistic Regression Model"") +"
"0","  theme_minimal()"
