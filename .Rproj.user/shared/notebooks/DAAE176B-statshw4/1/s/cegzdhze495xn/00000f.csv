"0","# Predict probabilities on test data"
"0","pred_test_probs <- predict(model_lr, newdata = dftest, type = ""response"")"
"0",""
"0","# Apply threshold"
"0","threshold <- 0.15"
"0","pred_test_class <- ifelse(pred_test_probs > threshold, 1, 0)"
"0",""
"0","# Confusion matrix"
"0","conf_matrix_test <- caret::confusionMatrix(as.factor(pred_test_class), as.factor(dftest$Y), positive = ""1"")"
"0",""
"0","# AUC"
"0","roc_test <- pROC::roc(dftest$Y, pred_test_probs)"
"2","Setting levels: control = 0, case = 1
"
"2","Setting direction: controls < cases
"
"0","auc_test <- pROC::auc(roc_test)"
"0",""
"0","list("
"0","  ConfusionMatrix = conf_matrix_test,"
"0","  AUC = auc_test"
"0",")"
"1","$ConfusionMatrix
"
"1","Confusion Matrix and Statistics

"
"1","          Reference
"
"1","Prediction"
"1","    0"
"1","    1"
"1","
         0"
"1"," 4715"
"1","  441"
"1","
         1"
"1","  380"
"1","  104"
"1","
"
"1",""
"1","                         "
"1","                "
"1","
"
"1","               Accuracy :"
"1"," 0.8544         "
"1","
"
"1","                 95% CI :"
"1"," (0.845, 0.8635)"
"1","
"
"1","    No Information Rate :"
"1"," 0.9034         "
"1","
"
"1","    P-Value [Acc > NIR] :"
"1"," 1.00000        "
"1","
"
"1","                         "
"1","                "
"1","
"
"1","                  Kappa :"
"1"," 0.1224         "
"1","
"
"1","                         "
"1","                "
"1","
"
"1"," Mcnemar's Test P-Value :"
"1"," 0.03626        "
"1","
"
"1","                         "
"1","                "
"1","
"
"1","            Sensitivity :"
"1"," 0.19083        "
"1","
"
"1","            Specificity :"
"1"," 0.92542        "
"1","
"
"1","         Pos Pred Value :"
"1"," 0.21488        "
"1","
"
"1","         Neg Pred Value :"
"1"," 0.91447        "
"1","
"
"1","             Prevalence :"
"1"," 0.09663        "
"1","
"
"1","         Detection Rate :"
"1"," 0.01844        "
"1","
"
"1","   Detection Prevalence :"
"1"," 0.08582        "
"1","
"
"1","      Balanced Accuracy :"
"1"," 0.55812        "
"1","
"
"1","                         "
"1","                "
"1","
"
"1","       'Positive' Class :"
"1"," 1              "
"1","
"
"1","                         "
"1","                "
"1","
"
"1","
"
"1","$AUC
"
"1","Area under the curve: "
"1",""
"1","0.6097"
"1",""
"1",""
"1",""
"1","
"
"1","
"
