"0","wcgs <- read.csv(""wcgs.csv"")"
"0",""
"0","# Clean and prepare data to match Table 5.18"
"0","wcgs_clean <- wcgs %>%"
"0","  mutate("
"0","    age_10 = age / 10,"
"0","    chol_50 = chol / 50,"
"0","    sbp_50 = sbp / 50,"
"0","    bmi_10 = bmi / 10,"
"0","    smoke = ifelse(smoke == ""Yes"", 1, 0),"
"0","    dibpat = ifelse(dibpat == ""Type A"", 1, 0),"
"0","    bmichol = bmi_10 * chol_50,"
"0","    bmisbp = bmi_10 * sbp_50,"
"0","    chd69 = ifelse(chd69 == ""Yes"", 1, 0)"
"0","  ) %>%"
"0","  select(chd69, age_10, chol_50, sbp_50, bmi_10, smoke, dibpat, bmichol, bmisbp) %>%"
"0","  na.omit()"
"0",""
"0","# Fit the logistic regression model"
"0","model_wcgs <- glm("
"0","  chd69 ~ age_10 + chol_50 + sbp_50 + bmi_10 + smoke + dibpat + bmichol + bmisbp,"
"0","  data = wcgs_clean,"
"0","  family = binomial"
"0",")"
"0",""
"0","# Display model summary"
"0","summary(model_wcgs)"
"1","
Call:
"
"1",""
"1","glm(formula = chd69 ~ age_10 + chol_50 + sbp_50 + bmi_10 + smoke + 
    dibpat + bmichol + bmisbp, family = binomial, data = wcgs_clean)"
"1",""
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","    "
"1","
(Intercept)"
"1"," -30.4014"
"1","     5.7426"
"1","  -5.294"
"1"," 1.20e-07"
"1"," ***"
"1","
age_10     "
"1","   0.5915"
"1","     0.1200"
"1","   4.929"
"1"," 8.29e-07"
"1"," ***"
"1","
chol_50    "
"1","   2.2917"
"1","     0.6250"
"1","   3.667"
"1"," 0.000246"
"1"," ***"
"1","
sbp_50     "
"1","   4.4312"
"1","     1.5830"
"1","   2.799"
"1"," 0.005122"
"1"," ** "
"1","
bmi_10     "
"1","   7.7342"
"1","     2.2521"
"1","   3.434"
"1"," 0.000594"
"1"," ***"
"1","
smoke      "
"1","   0.5948"
"1","     0.1407"
"1","   4.228"
"1"," 2.36e-05"
"1"," ***"
"1","
dibpat     "
"1","   0.7221"
"1","     0.1449"
"1","   4.985"
"1"," 6.20e-07"
"1"," ***"
"1","
bmichol    "
"1","  -0.6921"
"1","     0.2439"
"1","  -2.837"
"1"," 0.004550"
"1"," ** "
"1","
bmisbp     "
"1","  -1.3957"
"1","     0.6281"
"1","  -2.222"
"1"," 0.026268"
"1"," *  "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","binomial"
"1",""
"1"," family taken to be "
"1",""
"1","1"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 1779.2  on 3141  degrees of freedom
"
"1",""
"1","Residual deviance: 1578.6  on 3133  degrees of freedom
"
"1","AIC: "
"1",""
"1","1596.6"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","6"
"1",""
"1","
"
"1","
"
"0","# Predict probabilities from model"
"0","fitted_probs <- predict(model_wcgs, type = ""response"")"
"0",""
"0","# Hosmer-Lemeshow goodness-of-fit test"
"0","hoslem.test(wcgs_clean$chd69, fitted_probs, g = 10)"
"1","
"
"1","	Hosmer and Lemeshow goodness of fit (GOF) test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","wcgs_clean$chd69, fitted_probs"
"1",""
"1","
"
"1","X-squared = 12.097, df = 8, p-value = 0.1469"
"1","
"
"1","
"
"0","hoslem.test(wcgs_clean$chd69, fitted_probs, g = 15)"
"1","
"
"1","	Hosmer and Lemeshow goodness of fit (GOF) test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","wcgs_clean$chd69, fitted_probs"
"1",""
"1","
"
"1","X-squared = 21.622, df = 13, p-value = 0.06151"
"1","
"
"1","
"
"0","hoslem.test(wcgs_clean$chd69, fitted_probs, g = 20)"
"1","
"
"1","	Hosmer and Lemeshow goodness of fit (GOF) test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","wcgs_clean$chd69, fitted_probs"
"1",""
"1","
"
"1","X-squared = 20.514, df = 18, p-value = 0.3046"
"1","
"
"1","
"
"0","hoslem.test(wcgs_clean$chd69, fitted_probs, g = 25)"
"1","
"
"1","	Hosmer and Lemeshow goodness of fit (GOF) test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","wcgs_clean$chd69, fitted_probs"
"1",""
"1","
"
"1","X-squared = 25.389, df = 23, p-value = 0.3306"
"1","
"
"1","
"
